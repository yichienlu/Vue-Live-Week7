"use strict";(self["webpackChunkvue_live_week7"]=self["webpackChunkvue_live_week7"]||[]).push([[39],{6039:function(t,e,a){a.r(e),a.d(e,{default:function(){return Wt}});var s=a(6252);const n={class:"d-lg-none position-sticky bottom-0 bg-light",style:{"z-index":"1000"}},l={class:"container d-flex justify-content-between"};function o(t,e,a,o,i,r){const c=(0,s.up)("FrontNav"),d=(0,s.up)("router-view"),u=(0,s.up)("FrontCart"),p=(0,s.up)("FrontMember");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(c),(0,s.Wm)(d),(0,s._)("div",n,[(0,s._)("div",l,[(0,s.Wm)(u),(0,s.Wm)(p)])])],64)}var i=a(9963);const r={class:"d-flex align-items-center nav-item dropdown"},c=(0,s._)("a",{class:"nav-link link-secondary",href:"#",id:"navbarDropdown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[(0,s._)("i",{class:"bi bi-person-fill position-absolute top-50 start-50 translate-middle",style:{"font-size":"2rem"}})],-1),d={class:"dropdown-menu","aria-labelledby":"navbarDropdown"},u={key:0},p=(0,s.Uk)("後台"),h=(0,s.Uk)("我的訂單"),g=(0,s._)("li",null,[(0,s._)("hr",{class:"dropdown-divider"})],-1),m={key:1},b=(0,s.Uk)("登入"),v={key:2};function _(t,e,a,n,l,o){const _=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",r,[c,(0,s._)("ul",d,[l.loggedIn&&l.checkSuccess?((0,s.wg)(),(0,s.iD)("li",u,[(0,s.Wm)(_,{to:"/admin/products",class:"dropdown-item"},{default:(0,s.w5)((()=>[p])),_:1})])):(0,s.kq)("",!0),(0,s._)("li",null,[(0,s.Wm)(_,{to:"/orders",class:"dropdown-item"},{default:(0,s.w5)((()=>[h])),_:1})]),g,l.loggedIn?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("li",m,[(0,s.Wm)(_,{to:"/Login",class:"dropdown-item"},{default:(0,s.w5)((()=>[b])),_:1})])),l.loggedIn?((0,s.wg)(),(0,s.iD)("li",v,[(0,s._)("a",{href:"#",class:"dropdown-item",onClick:e[0]||(e[0]=(0,i.iM)(((...t)=>o.logOut&&o.logOut(...t)),["prevent"]))},"登出")])):(0,s.kq)("",!0)])])}var k={data(){return{loggedIn:!1,checkSuccess:!1}},methods:{checkAdmin(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");t&&(this.$http.defaults.headers.common.Authorization=t,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/user/check").then((()=>{this.loggedIn=!0})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))),this.$http.get("https://vue3-course-api.hexschool.io/v2/api/yclu/admin/products").then((()=>{this.checkSuccess=!0}))},logOut(){document.cookie="hexToken=;expires=;",this.emitter.emit("push-message",{style:"success",title:"登出",content:"已登出"}),this.loggedIn=!1,this.checkSuccess=!1}},mounted(){this.checkAdmin()}},w=a(3744);const y=(0,w.Z)(k,[["render",_]]);var f=y,C=a(3577);const x=(0,s._)("span",{class:"text-light"},"Cart",-1),D=(0,s._)("i",{class:"bi bi-cart-fill position-absolute top-50 start-50 translate-middle",style:{"font-size":"2rem"}},null,-1),I={class:"position-absolute top-50 start-50 translate-middle text-white"},$={class:"d-none d-lg-block nav-link position-relative link-secondary","data-bs-toggle":"collapse","data-bs-target":"#collapseExample",style:{cursor:"pointer"}},W=(0,s._)("span",{class:"text-light"},"Cart",-1),U=(0,s._)("i",{class:"bi bi-cart-fill position-absolute top-50 start-50 translate-middle",style:{"font-size":"2rem"}},null,-1),z={class:"position-absolute top-50 start-50 translate-middle text-white"},F={class:"collapse position-absolute top-100 end-0 bg-white shadow-sm p-3",id:"collapseExample"},M=(0,s._)("div",{class:"d-flex justify-content-between"},[(0,s._)("h5",null,"購物車"),(0,s._)("button",{type:"button",class:"btn btn-close","data-bs-toggle":"collapse","data-bs-target":"#collapseExample",role:"button","aria-expanded":"false","aria-controls":"collapseExample"})],-1),q={key:0,class:"my-5 text-center"},S=(0,s._)("span",{"data-bs-toggle":"collapse","data-bs-target":"#collapseExample"},"購物車裡沒有東西！快去逛逛吧！！",-1),L={key:1},E={class:"overflow-auto",style:{"max-height":"50vh"}},N={class:"table"},Z=(0,s._)("div",{class:"w-100 h-100"},null,-1),A=["src","alt"],P={class:"fw-bold"},j=(0,s.Uk)(" 價格： "),H={key:0},O={key:1},T={class:"text-secondary me-2"},Y=(0,s.Uk)(" 數量： "),V=(0,s._)("br",null,null,-1),K={class:"input-group input-group-sm mb-3"},B=["onClick"],G=["onUpdate:modelValue","onChange"],J=["onClick"],Q=["onClick","disabled"],R={class:"text-end mb-3"},X=(0,s.Uk)(" 總金額："),tt={class:"text-danger fw-bold"},et=(0,s.Uk)("元 "),at={class:"text-end"},st=(0,s._)("button",{class:"btn btn-danger","data-bs-toggle":"collapse","data-bs-target":"#collapseExample"},[(0,s.Uk)("去結帳 "),(0,s._)("i",{class:"bi bi-arrow-right"})],-1);function nt(t,e,a,n,l,o){const r=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(r,{to:"/Cart",class:"d-lg-none nav-link position-relative link-secondary",style:{cursor:"pointer"}},{default:(0,s.w5)((()=>[x,D,(0,s._)("small",I,(0,C.zw)(l.cartData.carts.length),1)])),_:1}),(0,s._)("a",$,[W,U,(0,s._)("small",z,(0,C.zw)(l.cartData.carts.length),1)]),(0,s._)("div",F,[M,0==l.cartData.carts.length?((0,s.wg)(),(0,s.iD)("div",q,[(0,s.Wm)(r,{to:"/products"},{default:(0,s.w5)((()=>[S])),_:1})])):((0,s.wg)(),(0,s.iD)("div",L,[(0,s._)("div",E,[(0,s._)("table",N,[(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.cartData.carts,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id,height:"100"},[(0,s._)("td",null,[(0,s.Wm)(r,{to:`/product/${t.product.id}`},{default:(0,s.w5)((()=>[Z,(0,s._)("img",{src:t.product.imageUrl,alt:t.product.title,height:"100"},null,8,A)])),_:2},1032,["to"])]),(0,s._)("td",null,[(0,s._)("div",null,[(0,s._)("h6",P,(0,C.zw)(t.product.title),1),(0,s._)("div",null,[j,t.product.price===t.product.origin_price?((0,s.wg)(),(0,s.iD)("span",H,(0,C.zw)(t.product.price)+" 元 ",1)):((0,s.wg)(),(0,s.iD)("span",O,[(0,s._)("small",T,[(0,s._)("del",null,(0,C.zw)(t.product.origin_price)+" 元",1)]),(0,s._)("span",null,(0,C.zw)(t.product.price)+" 元",1)]))]),(0,s._)("div",null,[Y,V,(0,s._)("div",K,[(0,s._)("button",{class:"btn btn-secondary",type:"button",onClick:e=>o.updateCartItem(t,-1)},"-",8,B),(0,s.wy)((0,s._)("input",{type:"number",onkeypress:"return (event.charCode == 8 || event.charCode == 0 || event.charCode == 13) ? null : event.charCode >= 48 && event.charCode <= 57",class:"form-control text-center","onUpdate:modelValue":e=>t.qty=e,onChange:e=>o.updateCartItem(t,0)},null,40,G),[[i.nr,t.qty,void 0,{number:!0}]]),(0,s._)("button",{class:"btn btn-secondary",type:"button",onClick:e=>o.updateCartItem(t,1)},"+",8,J)])])])]),(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>o.removeCartItem(t.id),disabled:l.isLoadingItem===t.id}," 刪除 ",8,Q)])])))),128))])])]),(0,s._)("div",R,[X,(0,s._)("span",tt,(0,C.zw)(l.cartData.total),1),et]),(0,s._)("div",at,[(0,s.Wm)(r,{to:"/cart",class:"link-secondary px-2"},{default:(0,s.w5)((()=>[st])),_:1})])]))])],64)}var lt=a(4902),ot={name:"FrontCart",data(){return{cartData:{carts:[]},isLoadingItem:""}},methods:{getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/yclu/cart").then((t=>{this.cartData=t.data.data})).catch((t=>{this.$httpMessageState(t.response,"錯誤訊息")}))},removeCartItem(t){this.isLoadingItem=t,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/yclu/cart/${t}`).then((t=>{this.$httpMessageState(t,"移除購物車品項"),this.getCart(),this.isLoadingItem=""})).catch((t=>{this.$httpMessageState(t.response,"移除購物車品項")}))},updateCartItem(t,e){if(t.qty+e===0)return void this.removeCartItem(t.id);if(t.qty+e<1||t.qty%1!==0)return void this.emitter.emit("push-message",{style:"success",title:"錯誤訊息",content:"輸入數量錯誤"});const a={product_id:t.id,qty:t.qty+e};this.isLoadingItem=t.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/yclu/cart/${t.id}`,{data:a}).then((t=>{this.$httpMessageState(t,"更新購物車"),this.getCart(),this.isLoadingItem=""})).catch((t=>{this.$httpMessageState(t.response,"更新購物車")}))}},mounted(){this.getCart(),lt.Z.on("get-cart",(()=>{this.getCart()}))}};const it=(0,w.Z)(ot,[["render",nt]]);var rt=it;const ct={class:"navbar navbar-expand-lg navbar-light bg-light sticky-top"},dt={class:"container position-relative justify-content-center align-items-center"},ut=(0,s.Uk)("Pet Pet"),pt=(0,s._)("button",{class:"navbar-toggler position-absolute top-0 end-0 me-2",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,s._)("span",{class:"navbar-toggler-icon"})],-1),ht={class:"collapse navbar-collapse",id:"navbarNav"},gt={class:"navbar-nav"},mt={class:"nav-item"},bt=(0,s.Uk)("About"),vt={class:"nav-item"},_t=(0,s.Uk)("商品列表"),kt={class:"nav-item"},wt=(0,s.Uk)("PetPet 資訊站"),yt={class:"d-none d-lg-flex"};function ft(t,e,a,n,l,o){const i=(0,s.up)("router-link"),r=(0,s.up)("FrontMember"),c=(0,s.up)("FrontCart");return(0,s.wg)(),(0,s.iD)("nav",ct,[(0,s._)("div",dt,[(0,s.Wm)(i,{to:"/",class:"navbar-brand"},{default:(0,s.w5)((()=>[ut])),_:1}),pt,(0,s._)("div",ht,[(0,s._)("ul",gt,[(0,s._)("li",mt,[(0,s.Wm)(i,{to:"/about",class:"nav-link"},{default:(0,s.w5)((()=>[bt])),_:1})]),(0,s._)("li",vt,[(0,s.Wm)(i,{to:"/products",class:"nav-link"},{default:(0,s.w5)((()=>[_t])),_:1})]),(0,s._)("li",kt,[(0,s.Wm)(i,{to:"/blog",class:"nav-link"},{default:(0,s.w5)((()=>[wt])),_:1})])])]),(0,s._)("div",yt,[(0,s.Wm)(r),(0,s.Wm)(c)])])])}var Ct={name:"FrontNav",components:{FrontMember:f,FrontCart:rt}};const xt=(0,w.Z)(Ct,[["render",ft]]);var Dt=xt,It={components:{FrontMember:f,FrontCart:rt,FrontNav:Dt}};const $t=(0,w.Z)(It,[["render",o]]);var Wt=$t}}]);
//# sourceMappingURL=39.042e7c1c.js.map